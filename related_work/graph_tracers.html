<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Graph Tracers &mdash; Ivy 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="icon" type="image/png" href="https://github.com/unifyai/unifyai.github.io/blob/master/img/externally_linked/ivy_logo_only.png?raw=true">
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exchange Formats" href="exchange_formats.html" />
    <link rel="prev" title="Frameworks" href="frameworks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Ivy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Design</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../related_work.html">Related Work</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api_standards.html">API Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="wrapper_frameworks.html">Wrapper Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="frameworks.html">Frameworks</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Graph Tracers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tf-graph">tf.Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jaxpr">Jaxpr</a></li>
<li class="toctree-l3"><a class="reference internal" href="#torch-jit">torch.jit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#torch-fx">torch.fx</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="exchange_formats.html">Exchange Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="compiler_infrastructure.html">Compiler Infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_vendor_compiler_frameworks.html">Multi-Vendor Compiler Frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="vendor_specific_apis.html">Vendor-Specific APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="vendor_specific_compilers.html">Vendor-Specific Compilers</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml_unifying_companies.html">ML-Unifying Companies</a></li>
<li class="toctree-l2"><a class="reference internal" href="what_does_ivy_add.html">What does Ivy Add?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deep_dive.html">Deep Dive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../functional/experimental.html">Experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/compilation.html">Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/creation.html">Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/data_type.html">Data type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/device.html">Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/elementwise.html">Elementwise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/gradients.html">Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/linear_algebra.html">Linear algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/manipulation.html">Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/meta.html">Meta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/nest.html">Nest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/random.html">Random</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/searching.html">Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/set.html">Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/sorting.html">Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/statistical.html">Statistical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional/ivy/utility.html">Utility</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../data_classes/container.html">Container</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_classes/array.html">Array</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Framework Classes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stateful/norms.html">Norms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/initializers.html">Initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/sequential.html">Sequential</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/activations.html">Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/layers.html">Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/module.html">Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stateful/converters.html">Converters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ivy"">Ivy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mech"">Ivy mech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vision"">Ivy vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../robot"">Ivy robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gym"">Ivy gym</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../memory"">Ivy memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builder"">Ivy builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models"">Ivy models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ecosystem"">Ivy ecosystem</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ivy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../related_work.html">Related Work</a> &raquo;</li>
      <li>Graph Tracers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/related_work/graph_tracers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="graph-tracers">
<span id="rworks-graph-tracers"></span><h1>Graph Tracers<a class="headerlink" href="#graph-tracers" title="Permalink to this heading"></a></h1>
<p>Graph tracers enable acyclic directed computation graphs to be extracted from functions which operate on the tensors, expressed as source code in the framework.
There is inevitably some overlap with the role of the lower level compilers here, but for the purpose of this discussion we consider tracers as being any tool which: execute the function to be traced and produce a computation graph consisting solely of the lowest level functions defined within the framework itself, without going any lower.
In this light, the tracer does not need to know about the hardware, the compiler instruction set, or anything else lower level.
It simply creates an acyclic directed graph which maps the inputs of a function to the outputs of a function, as a composition of the low level functions defined within the framework.
This is a very useful representation which can then make subsequent compilation simpler, and so this graph representation often sits between the raw source code and the lower level compilers which compile to specific hardware.</p>
<section id="tf-graph">
<h2>tf.Graph<a class="headerlink" href="#tf-graph" title="Permalink to this heading"></a></h2>
<p>The <code class="code docutils literal notranslate"><span class="pre">tf.Graph</span></code> class represents an arbitrary <a class="reference external" href="https://tensorflow.org/">TensorFlow</a> computation, represented as a dataflow graph.
It is used by <code class="code docutils literal notranslate"><span class="pre">tf.function</span></code> to represent the function’s computations.
Each graph contains a set of <code class="code docutils literal notranslate"><span class="pre">tf.Operation</span></code> instances, which represent units of computation; and <code class="code docutils literal notranslate"><span class="pre">tf.Tensor</span></code> instances, which represent the units of data that flow between operations.</p>
</section>
<section id="jaxpr">
<h2>Jaxpr<a class="headerlink" href="#jaxpr" title="Permalink to this heading"></a></h2>
<p>Conceptually, one can think of <a class="reference external" href="https://jax.readthedocs.io/">JAX</a> transformations as first trace-specializing the Python function to be transformed into a small and well-behaved intermediate form that is then interpreted with transformation-specific interpretation rules.
It uses the actual Python interpreter to do most of the heavy lifting to distill the essence of the computation into a simple statically-typed expression language with limited higher-order features.
That language is the jaxpr language.
A <code class="code docutils literal notranslate"><span class="pre">jax.core.Jaxpr</span></code> instance represents a function with one or more typed parameters (input variables) and one or more typed results.
The results depend only on the input variables; there are no free variables captured from enclosing scopes.</p>
</section>
<section id="torch-jit">
<h2>torch.jit<a class="headerlink" href="#torch-jit" title="Permalink to this heading"></a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">torch.jit.trace</span></code> and <code class="code docutils literal notranslate"><span class="pre">torch.jit.trace_module</span></code> enable a module or Python function to be traced in <a class="reference external" href="https://pytorch.org/">PyTorch</a>, and an executable is returned which will be optimized using just-in-time compilation.
Example inputs must be provided, and then the function is run, with recording of the operations performed on all the tensors.
The resulting recording of a standalone function produces a <code class="code docutils literal notranslate"><span class="pre">ScriptFunction</span></code> instance.
The resulting recording of <code class="code docutils literal notranslate"><span class="pre">nn.Module.forward</span></code> or <code class="code docutils literal notranslate"><span class="pre">nn.Module</span></code> produces a <code class="code docutils literal notranslate"><span class="pre">ScriptModule</span></code> instance.
This module also contains any parameters that the original module had as well.</p>
</section>
<section id="torch-fx">
<h2>torch.fx<a class="headerlink" href="#torch-fx" title="Permalink to this heading"></a></h2>
<p><a class="reference external" href="https://pytorch.org/docs/stable/fx.html">FX</a> is a toolkit for developers to use to transform <code class="code docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> instances in <a class="reference external" href="https://pytorch.org/">PyTorch</a>.
FX consists of three main components: a symbolic tracer, an intermediate representation, and Python code generation.
The symbolic tracer performs “symbolic execution” of the Python code.
It feeds fake values, called Proxies, through the code.
Operations on these Proxies are recorded.
The intermediate representation is the container for the operations that were recorded during symbolic tracing.
It consists of a list of Nodes that represent function inputs, call-sites (to functions, methods, or <code class="code docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> instances), and return values.
The IR is the format on which transformations are applied.
Python code generation is what makes FX a Python-to-Python (or Module-to-Module) transformation toolkit.
For each Graph IR, valid Python code matching the Graph’s semantics can be created.
This functionality is wrapped up in GraphModule, which is a <code class="code docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> instance that holds a Graph as well as a forward method generated from the Graph.</p>
<p>Taken together, this pipeline of components (symbolic tracing -&gt; intermediate representation -&gt; transforms -&gt; Python code generation) constitutes the Python-to-Python transformation pipeline of FX.
In addition, these components can be used separately.
For example, symbolic tracing can be used in isolation to capture a form of the code for analysis (and not transformation) purposes.
Code generation can be used for programmatically generating models, for example from a config file.</p>
<p><strong>Round Up</strong></p>
<p>If you have any questions, please feel free to reach out on <a class="reference external" href="https://discord.gg/sXyFF8tDtm">discord</a> in the <a class="reference external" href="https://discord.com/channels/799879767196958751/1034436036371157083">related work channel</a> or in the <a class="reference external" href="https://discord.com/channels/799879767196958751/1034436085587120149">related work forum</a>!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="frameworks.html" class="btn btn-neutral float-left" title="Frameworks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="exchange_formats.html" class="btn btn-neutral float-right" title="Exchange Formats" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2022, Ivy Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>